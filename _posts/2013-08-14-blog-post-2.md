---
title: 'How does the math for DeSeq2 work (library normalization)?'
date: 2024-07-21
permalink: /posts/2013/08/blog-post-2/
tags:
  - Math
  - Learning
  - Deseq2
---

For this blog post I took inspiration from [DeSeq2 Library Normalization](https://www.youtube.com/watch?v=UFB993xufUU&ab_channel=StatQuestwithJoshStarmer). I just could not find the math for DeSeq2 written out simply thus I wrote this. 

Now for the content. Why do we even use DeSeq2?

DeSeq2 is very useful due to adjusting for differences in library sizes (raw counts) due to differing sequencing depth. For example if my accessory venom gland has 700 reads but my main venom gland has 2,000 DeSeq2 is able to accomodate that. 

Another reason Deseq2 is very useful is that it can adjust for differential expression among different tissue types such as my accessory vs main venom gland. This can be because certain genes might naturally be more expressed in accessory compared to the main venom gland thus normalizing it and getting an accurate differential expression is important.


Step 1
======
DeSeq2 takes the raw library counts and takes the log of each sample. 

Here we will start out with the raw count table and transform it by putting each number of these numbers through log(e). 

| Gene | Gene raw count #1 | Gene raw count # 2 | Gene raw count # 3 | Gene raw count #4
| :-: | :-: | :-: | :-: | :-:
| Gene #1 |10|20|9|0
| Gene #2 |20|13|15|8
| Gene #3 |5|6|19|8
| Gene #4 |10|8|7|9


When all the numbers are put through latex it leads to the table below

| Gene | Gene raw count #1 | Gene raw count # 2 | Gene raw count # 3 | Gene raw count #4
| :-: | :-: | :-: | :-: | :-:
| Gene #1 |2.3|8.686|3.909|-InF
| Gene #2 |8.686|5.646|6.514|3.474
| Gene #3 |2.171|2.606|8.252|3.474
| Gene #4 |2.3|3.474|3.04|3.909


Step 2
======

We then take the averages of each row (AVG Gene #1,#2;MVG Gene #1,#2) from log(e) table from Step 1.

| Gene | Averaged log |
| :-: | :-: | :-: |
| Gene #1 |-Inf|
| Gene #2 |6.08|
| Gene #3 |4.125|
| Gene #4 |3.18075|


Step 3
======


